(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{0:function(t,n){},1:function(t,n){},2:function(t,n){},Kink:function(t,n,r){"use strict";r.d(n,"a",(function(){return c})),r.d(n,"b",(function(){return u})),r.d(n,"d",(function(){return d})),r.d(n,"e",(function(){return f})),r.d(n,"c",(function(){return h}));var e=r("o0o1"),a=r.n(e);function s(t,n,r,e,a,s,o){try{var c=t[s](o),i=c.value}catch(t){return void r(t)}c.done?n(i):Promise.resolve(i).then(e,a)}function o(t){return function(){var n=this,r=arguments;return new Promise((function(e,a){var o=t.apply(n,r);function c(t){s(o,e,a,c,i,"next",t)}function i(t){s(o,e,a,c,i,"throw",t)}c(void 0)}))}}function c(){return i.apply(this,arguments)}function i(){return(i=o(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.get("/ajax/users"));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(){return l.apply(this,arguments)}function l(){return(l=o(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.get("/ajax/profile"));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(t){return v.apply(this,arguments)}function v(){return(v=o(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.post("/ajax/cards/send",n));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(){return p.apply(this,arguments)}function p(){return(p=o(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.get("/ajax/cards/sent"));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(){return m.apply(this,arguments)}function m(){return(m=o(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.get("/ajax/cards/received"));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},ilsw:function(t,n,r){"use strict";r.r(n);var e=r("o0o1"),a=r.n(e),s=r("XuX8"),o=r.n(s),c=r("OFL0"),i=r.n(c),u=o.a.mixin({methods:{isInvalid:function(t){return!!i()(this.error.errors,t)},invalidFeedback:function(t){return i()(this.error.errors,t)?this.error.errors[t][0]:null}}}),l=r("epSk"),d=r("Kink");function v(t,n,r,e,a,s,o){try{var c=t[s](o),i=c.value}catch(t){return void r(t)}c.done?n(i):Promise.resolve(i).then(e,a)}function f(t){return function(){var n=this,r=arguments;return new Promise((function(e,a){var s=t.apply(n,r);function o(t){v(s,e,a,o,c,"next",t)}function c(t){v(s,e,a,o,c,"throw",t)}o(void 0)}))}}var p={name:"CardsCreatePage",mixins:[u],components:{Photoshop:r("w0Wi").Photoshop},watch:{colors:function(t){this.canvasInstance.backgroundColor=this.colors.hex,this.canvasInstance.renderAll()}},data:function(){return{colors:{hex:"#72BA96",hsl:{h:150,s:.5,l:.2,a:1},hsv:{h:150,s:.66,v:.3,a:1},rgba:{r:25,g:77,b:51,a:1},a:1},text:"Sample text",canvas:{},canvasInstance:{},error:{},cardUrl:null,form:{},users:[],saving:!1}},methods:{onCanvasBgColorChange:function(){this.canvasInstance.backgroundColor=this.canvas.bgColor,this.canvasInstance.renderAll()},addText:function(){this.addTextToCanvas(this.text)},addTextToCanvas:function(t){if(t){var n=(new Date).getTime().toString().substr(5),r=new l.fabric.IText(t,{fontFamily:"arial black",left:100,top:100,myid:n,objecttype:"text"});this.canvasInstance.add(r)}},send:function(){var t=this;return f(a.a.mark((function n(){var r,e,s,o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.saving){n.next=2;break}return n.abrupt("return");case 2:return t.saving=!0,t.error={},s=document.querySelector("canvas"),(o=new FormData).append("to",null!==(r=t.form.to)&&void 0!==r?r:""),o.append("card",null!==(e=s.toDataURL())&&void 0!==e?e:""),n.prev=8,n.next=11,Object(d.d)(o);case 11:n.sent,notify_success("Greeting Card Succesfully sent!"),t.saving=!1,n.next=20;break;case 16:n.prev=16,n.t0=n.catch(8),t.saving=!1,t.error=n.t0.response.data;case 20:case"end":return n.stop()}}),n,null,[[8,16]])})))()},exportCanvas:function(){var t=document.querySelector("canvas"),n=document.createElement("a");n.innerHTML="download image",n.addEventListener("click",(function(r){n.href=t.toDataURL(),n.download="canvas.png"}),!1),n.click()}},created:function(){var t=this;return f(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.prev=1,n.next=4,Object(d.a)();case 4:r=n.sent,t.users=r.data,t.loading=!1,n.next=14;break;case 9:n.prev=9,n.t0=n.catch(1),t.loading=!1,t.error=n.t0.response.data,notify_error(error_processing_message());case 14:case"end":return n.stop()}}),n,null,[[1,9]])})))()},mounted:function(){this.canvasInstance=new l.fabric.Canvas("cardCanvas"),this.canvasInstance.backgroundColor=this.colors.hex,this.canvasInstance.renderAll()}},h=r("KHd+"),m=Object(h.a)(p,(function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"col-md-8"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[t._v("Create Card")]),t._v(" "),r("div",{staticClass:"card-body"},[r("form",[t._m(0),t._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"canvas-text"}},[t._v("Add Text")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control w-50",attrs:{type:"text",id:"canvas-text"},domProps:{value:t.text},on:{input:function(n){n.target.composing||(t.text=n.target.value)}}}),t._v(" "),r("button",{staticClass:"btn btn-sm btn-info mt-2",on:{click:function(n){return n.preventDefault(),t.addText(n)}}},[t._v("Add Text")])]),t._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"canvas-bg-color"}},[t._v("Background Color")]),t._v(" "),r("photoshop",{model:{value:t.colors,callback:function(n){t.colors=n},expression:"colors"}})],1),t._v(" "),r("hr"),t._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"user"}},[t._v("Send to User")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.form.to,expression:"form.to"}],staticClass:"form-control w-50",class:{"is-invalid":t.isInvalid("to")},attrs:{id:"user"},on:{change:function(n){var r=Array.prototype.filter.call(n.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"to",n.target.multiple?r:r[0])}}},t._l(t.users,(function(n,e){return r("option",{key:e,domProps:{value:n.id}},[t._v("\n                            "+t._s(n.name)+"\n                        ")])})),0),t._v(" "),r("div",{staticClass:"invalid-feedback"},[t._v("\n                        "+t._s(t.invalidFeedback("to"))+"\n                    ")])]),t._v(" "),r("hr"),t._v(" "),r("button",{staticClass:"btn btn-info",attrs:{type:"button"},on:{click:function(n){return n.preventDefault(),t.exportCanvas(n)}}},[t._v("Export as Image")]),t._v(" "),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.saving},on:{click:function(n){return n.preventDefault(),t.send(n)}}},[t._v("\n                "+t._s(t.saving?"Sending...":"Send"))])])])])])}),[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"form-group"},[n("div",{staticClass:"canvas-container w-full"},[n("canvas",{staticStyle:{border:"1px solid #ccc"},attrs:{id:"cardCanvas",width:"400",height:"400"}})])])}],!1,null,null,null);n.default=m.exports}}]);